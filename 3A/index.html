<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project 3A — Homographies, Warping & Mosaics (CS180)</title>
  <meta name="description" content="A.2 homography from correspondences, A.3 inverse warping (NN/Bilinear) + rectification, and A.4 feathered mosaicing." />
  <style>
    :root{
      --bg:#f5f9ff; --ink:#0e1b2c; --muted:#5a6b82;
      --accent:#3b82f6; --accent-2:#60a5fa;
      --card:#ffffff; --border:#e6edf7;
      --shadow:0 10px 25px rgba(25,74,142,.12);
      --radius:18px; --max:1080px;
    }
    html,body{background:var(--bg); color:var(--ink); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, "Helvetica Neue", Arial}
    body{margin:0; padding:28px 18px 56px}
    .wrap{max-width:var(--max); margin:0 auto}
    a{color:var(--accent); text-decoration:none}
    header{margin-bottom:1rem}
    h1{font-size:clamp(1.6rem, 1.15rem + 2vw, 2.4rem); line-height:1.15; margin:.25rem 0}
    .pill{display:inline-block; padding:.25rem .6rem; border-radius:999px; border:1px solid rgba(59,130,246,.25); background:rgba(59,130,246,.12); color:#0b3a7a; font-weight:600; font-size:.85rem}

    .card{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); padding:18px; box-shadow:var(--shadow); margin:18px 0}
    .grid{display:grid; gap:14px}
    .two{grid-template-columns:1fr}
    .three{grid-template-columns:1fr}
    .four{grid-template-columns:1fr}
    @media(min-width:780px){
      .two{grid-template-columns:1fr 1fr}
      .three{grid-template-columns:1fr 1fr 1fr}
      .four{grid-template-columns:1fr 1fr 1fr 1fr}
    }

    figure{margin:0}
    img{width:100%; height:auto; display:block; border-radius:14px; border:1px solid var(--border)}
    figcaption{margin-top:.4rem; color:var(--muted); font-size:.95rem}
    h2{margin:.25rem 0 .65rem; font-size:1.3rem}
    h3{margin:.25rem 0 .4rem; font-size:1.05rem}
    .why{border-left:3px solid var(--accent); padding:.5rem .75rem; background:rgba(59,130,246,.06); border-radius:.5rem}
    .hr{height:1px; background:var(--border); margin:1.5rem 0}
    footer{margin-top:2rem; color:var(--muted); font-size:.95rem}
    .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; background:#eef4ff; border:1px solid #d7e5ff; padding:2px 6px; border-radius:6px}
    code{background:#f3f6ff; border:1px solid #e6edf7; padding:.1rem .3rem; border-radius:6px}
    pre{background:#f3f6ff; border:1px solid #e6edf7; padding:.6rem .75rem; border-radius:10px; overflow:auto}
    @media print{ body{padding:0; background:#fff} .card{box-shadow:none} a[href]:after{content:""} }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <a href="/">← Back to Home</a>
      <h1>Project 3A — Homographies, Warping & Mosaics</h1>
      <span class="pill">CS180</span>
      <p style="margin:.5rem 0 0; color:var(--muted)">All figures below are displayed directly on the page (no zoom needed). Source & result assets live in <code>3A/media/</code>.</p>
    </header>

    <!-- =========================
         A.2 — HOMOGRAPHY
         ========================= -->
    <section class="card" id="a2">
      <h2>A.2 — Point Correspondences & Homography Estimation</h2>
      <p>
        I estimate a projective homography <code>H</code> from at least four 2D correspondences using a linear least-squares system.
        For each match \((x,y)\mapsto(x',y')\) we linearize
        \(x'=\frac{h_{00}x+h_{01}y+h_{02}}{h_{20}x+h_{21}y+h_{22}}\),
        \(y'=\frac{h_{10}x+h_{11}y+h_{12}}{h_{20}x+h_{21}y+h_{22}}\),
        fix \(h_{22}=1\), and solve for the remaining 8 unknowns with <code>scipy.linalg.lstsq</code>.
      </p>
      <div class="grid two">
        <figure><img src="media/IMG_9770.JPG" alt="Original IMG_9770"><figcaption>Original Source — <strong>IMG_9770</strong></figcaption></figure>
        <figure><img src="media/IMG_9771.JPG" alt="Original IMG_9771"><figcaption>Original Reference — <strong>IMG_9771</strong></figcaption></figure>
      </div>
      <div class="grid two" style="margin-top:.8rem">
        <figure><img src="media/correspondences.png" alt="Labeled correspondences"><figcaption>Labeled point correspondences used to solve for <code>H</code>.</figcaption></figure>
        <div class="why">
          <p><strong>Approach details:</strong> Build matrix <code>A</code> (2 rows per correspondence) and vector <code>b</code>, solve <code>A·h ≈ b</code>. I then form</p>
          <pre>H = [[h00, h01, h02],
     [h10, h11, h12],
     [h20, h21, 1.0]]</pre>
          <p>After computing <code>H</code>, I verify by projecting each source point and reporting average reprojection error.</p>
        </div>
      </div>
    </section>

    <div class="hr"></div>

    <!-- =========================
         A.3 — WARPING
         ========================= -->
    <section class="card" id="a3">
      <h2>A.3 — Inverse Warping (Nearest Neighbor vs Bilinear)</h2>
      <p>
        I perform <em>inverse</em> warping: for each pixel in the output canvas, map its coordinates back via <code>H⁻¹</code> into the source, then sample.
        I implement two interpolations:
        <strong>Nearest Neighbor</strong> (fast, aliased edges) and <strong>Bilinear</strong> (smooth, less aliasing).
      </p>

      <h3 style="margin-top:.5rem">Direct Comparison (Warped IMG_9770 → IMG_9771’s frame)</h3>
      <div class="grid two">
        <figure><img src="media/warped_im1_nearest_neighbor.jpg" alt="Warped NN"><figcaption>Warped with <strong>Nearest Neighbor</strong></figcaption></figure>
        <figure><img src="media/warped_im1_bilinear.jpg" alt="Warped Bilinear"><figcaption>Warped with <strong>Bilinear</strong></figcaption></figure>
      </div>

      <h3 style="margin-top:1rem">Montage Visualizations</h3>
      <div class="grid two">
        <figure><img src="media/warping_nearest_neighbor.png" alt="NN montage"><figcaption>Originals + NN warp montage</figcaption></figure>
        <figure><img src="media/warping_bilinear.png" alt="Bilinear montage"><figcaption>Originals + Bilinear warp montage</figcaption></figure>
      </div>

      <div class="why" style="margin-top:.8rem">
        <strong>Observation:</strong> NN preserves crisp pixel edges but introduces stair-stepping on slanted lines; Bilinear reduces aliasing at the cost of slight blur (expected).
      </div>
    </section>

    <div class="hr"></div>

    <!-- =========================
         RECTIFICATION
         ========================= -->
    <section class="card" id="rectification">
      <h2>Planar Rectification</h2>
      <p>
        Given 4 user-clicked corners of a planar rectangle in the image, I compute a homography that maps them to an axis-aligned rectangle
        (here 500×400), producing a <em>fronto-parallel</em> view.
      </p>

      <div class="grid two">
        <figure><img src="media/rectification_pot.png" alt="Pot rectification montage"><figcaption>Rectification montage — <strong>pot.JPG</strong> (selected corners → target rectangle → rectified)</figcaption></figure>
        <figure><img src="media/rectification_sign.png" alt="Sign rectification montage"><figcaption>Rectification montage — <strong>sign.JPG</strong></figcaption></figure>
      </div>

      <div class="grid two" style="margin-top:.8rem">
        <figure><img src="media/pot.JPG" alt="Original pot"><figcaption>Original — pot.JPG</figcaption></figure>
        <figure><img src="media/rectified_pot.jpg" alt="Rectified pot"><figcaption>Rectified — pot (500×400)</figcaption></figure>
      </div>

      <div class="grid two" style="margin-top:.8rem">
        <figure><img src="media/sign.JPG" alt="Original sign"><figcaption>Original — sign.JPG</figcaption></figure>
        <figure><img src="media/rectified_sign.jpg" alt="Rectified sign"><figcaption>Rectified — sign (500×400)</figcaption></figure>
      </div>

      <div class="why" style="margin-top:.8rem">
        <strong>Approach details:</strong> compute <code>H = computeH(rect_pts, target_pts)</code>, then inverse-warp using Bilinear interpolation to the target size.
      </div>
    </section>

    <div class="hr"></div>

    <!-- =========================
         A.4 — MOSAICS
         ========================= -->
    <section class="card" id="a4">
      <h2>A.4 — Mosaicing with Feathered Blending</h2>
      <p>
        I create a <em>union canvas</em> large enough to hold the reference image and the warped source.
        I translate coordinates to positive space, warp image 1 with <code>H</code> into this canvas, then apply <em>feathered alpha blending</em>:
        alphas fall linearly toward each image’s edges to reduce seams. This keeps the mosaic relatively seamless while preserving structure.
      </p>

      <h3>Pair 1 — 9770_9771</h3>
      <div class="grid two">
        <figure><img src="media/mosaic_9770_9771.jpg" alt="Mosaic 9770_9771"><figcaption>Final mosaic</figcaption></figure>
        <figure><img src="media/mosaic_9770_9771_visualization.png" alt="Mosaic viz 9770_9771"><figcaption>Visualization (inputs, warp, blend)</figcaption></figure>
      </div>
      <div class="grid two" style="margin-top:.6rem">
        <figure><img src="media/IMG_9770.JPG" alt="Original 9770"><figcaption>Original — IMG_9770</figcaption></figure>
        <figure><img src="media/IMG_9771.JPG" alt="Original 9771"><figcaption>Original — IMG_9771</figcaption></figure>
      </div>

      <h3 style="margin-top:1rem">Pair 2 — 9772_9773</h3>
      <div class="grid two">
        <figure><img src="media/mosaic_9772_9773.jpg" alt="Mosaic 9772_9773"><figcaption>Final mosaic</figcaption></figure>
        <figure><img src="media/mosaic_9772_9773_visualization.png" alt="Mosaic viz 9772_9773"><figcaption>Visualization</figcaption></figure>
      </div>

      <h3 style="margin-top:1rem">Pair 3 — 9782_9783</h3>
      <div class="grid two">
        <figure><img src="media/mosaic_9782_9783.jpg" alt="Mosaic 9782_9783"><figcaption>Final mosaic</figcaption></figure>
        <figure><img src="media/mosaic_9782_9783_visualization.png" alt="Mosaic viz 9782_9783"><figcaption>Visualization</figcaption></figure>
      </div>

      <div class="why" style="margin-top:.8rem">
        <strong>Notes on sharpness:</strong> The pipeline avoids any downscaling; warps use full resolution.
        NN can look sharper but aliasy; Bilinear is smoother (slightly softer edges) but avoids jaggies.
        Feather weights (<code>center=1.0</code>, <code>edge≈0.2</code>) reduce exposure/illumination seams at overlaps.
      </div>
    </section>

    <section class="card" id="reflection">
      <h2>Key Takeaways</h2>
      <ul style="margin:.3rem 0 .2rem">
        <li><strong>Homography quality</strong> is dominated by good, well-spread correspondences (include corners and points near the image periphery).</li>
        <li><strong>Inverse warping</strong> eliminates holes and makes interpolation explicit and controllable.</li>
        <li><strong>Feathered blending</strong> is a simple, effective baseline for mosaics; exposure compensation or multi-band blending can further reduce seams.</li>
      </ul>
    </section>

    <footer>
      <div class="hr"></div>
      <p>© <span id="year"></span> Raymond Wang • <a href="https://raymond23101.github.io">raymond23101.github.io</a></p>
    </footer>
  </div>
  <script>document.getElementById('year').textContent = new Date().getFullYear();</script>
</body>
</html>
